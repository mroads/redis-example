<html>
<head>
    <script src="./socket.io.js"></script>
    <style>
        button {
            width: 100px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
    </style>
</head>

<body style="display:flex;flex:1;flex-direction:column;">
    <div style="display:flex;width:100%;flex-direction: row;flex-wrap: wrap;">
        <input id="inputMessage" type="text" />
        <button id="send" onclick="sendMessage()">Send</button>
        <button id="getMessages" onclick="getMessages()">Get Messages</button>
    </div>
    <div id="response"></div>
</body>

<script>
    const inputMessage = document.getElementById('inputMessage');
    const response = document.getElementById('response');
    const socket = io();

    socket.on('connect', function () {
        console.info('connected');
    });
    socket.on('disconnect', function (reason) {
        console.info('reason', reason);
    });
    socket.on('messages', function(msg){
        console.log("get messages subscription", msg.message);
        response.innerHTML += '     ' +msg.message;
    });

    function sendMessage() {
        socket.emit('send', inputMessage.value);
    }

    function getMessages() {
        console.info('subscribing to messages');
        socket.emit('messages', (error, data) => {
            console.info('response', error, data);
            response.innerHTML += data;
        });
    }

</script>

</html>